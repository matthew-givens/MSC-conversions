function P_MSC = cov2MSC(x,P_rel)

q1 = norm(x(1:3,1));
q2 = norm(x(1:2,1));

J11 = -x(1)*x(3)/q1^2/q2;
J12 = -x(2)*x(3)/q1^2/q2;
J13 = q2/q1^2;
J21 = (x(1)*x(6)*q2^2*(x(3)^2-q2^2)-x(3)*x(4)*(x(2)^4+x(2)^2*x(3)^2-2*x(1)^4 - ...
    x(1)^2*x(2)^2) + x(1)*x(2)*x(3)*x(5)*(q1^2+2*q2^2))/(q1^4*q2^3);
J22 = (x(2)*x(6)*q2^2*(x(3)^2-q2^2)-x(3)*x(5)*(x(1)^4-x(1)^2*x(2)^2-2*x(2)^4 + ...
    x(1)^2*x(3)^2) + x(1)*x(2)*x(3)*x(4)*(q1^2+2*q2^2))/(q1^4*q2^3);
J23 = ((x(1)*x(4)+x(2)*x(5))*(x(3)^2-q2^2)-2*x(3)*x(6)*q2^2)/(q1^4*q2);
J24 = -x(1)*x(3)/q1^2/q2;
J25 = -x(2)*x(3)/q1^2/q2;
J26 = q2/q1^2;
J31 = -x(2)/q2^2;
J32 = x(1)/q2^2;
J41 = (x(5)*(x(2)^4+x(2)^2*x(3)^2-x(1)^4)+x(1)*x(2)*x(4)*(q1^2+q2^2))/...
    (q1^3*q2^3);
J42 = (x(4)*(x(2)^4-x(1)^2*x(3)^2-x(1)^4)-x(1)*x(2)*x(5)*(q1^2+q2^2))/...
    (q1^3*q2^3);
J43 = -x(3)*(x(1)*x(5)-x(2)*x(4))/(q1^3*q2);
J44 = -x(2)/q1/q2;
J45 = x(1)/q1/q2;
J51 = (x(4)*(q1^2-2*x(1)^2)-2*x(1)*(x(2)*x(5)+x(3)*x(6)))/q1^4;
J52 = (x(5)*(q1^2-2*x(2)^2)-2*x(2)*(x(1)*x(4)+x(3)*x(6)))/q1^4;
J53 = (x(6)*(q1^2-2*x(3)^2)-2*x(3)*(x(1)*x(4)+x(2)*x(5)))/q1^4;
J54 = x(1)/q1^2;
J55 = x(2)/q1^2;
J56 = x(3)/q1^2;
J61 = -x(1)/q1^3;
J62 = -x(2)/q1^3;
J63 = -x(3)/q1^3;

J = [J11,J12,J13,0,0,0;
    J21,J22,J23,J24,J25,J26;
    J31,J32,0,0,0,0;
    J41,J42,J43,J44,J45,0;
    J51,J52,J53,J54,J55,J56;
    J61,J62,J63,0,0,0];

P_MSC = J*P_rel*J.';

end